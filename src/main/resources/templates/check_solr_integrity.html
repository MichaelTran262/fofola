<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
    <head lang="en" th:replace="layout :: header (page_title='Fofola')"></head>

    <body>

        <a href="/"><img src="home.png" width="100" height="100"></a>

        <div class="container" th:if="${not running_process and not problems_exist}">

            <div class="white-rounded-back" style="width: 700px;">

                <div style="text-align: center; top: 50%; padding-top: 3%">
                    <p>Celkem dokumentů v Solru: <span th:text="${total}"></span> </p>
                </div>

            </div>

            <div style="padding: 3% 0">
                <div class="card scrollable-list" style="width:700px;">
                    <table id="modelInfo" class="table table-light" style="text-align: center;">
                        <thead class="thead-light">
                        <tr>
                            <th> Model </th>
                            <th> Počet </th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:if="${modelCount.isEmpty()}">
                            <td colspan="2"> No models available </td>
                        </tr>

                        <tr th:each="record : ${modelCount}">
                            <td th:text="${record.key}"> Model name </td>
                            <td th:text="${record.value}"> Doc count </td>

                            <td>
                                <form action="#" th:action="@{/check_solr_integrity}" method="post">
                                    <input type="hidden" name="model" th:value="${record.key}">
                                    <input type="hidden" name="docCount" th:value="${record.value}">
                                    <button class="btn btn-light btn-outline-secondary" type="submit" name="action" value="run"> Zkontrolovat </button>
                                </form>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>

        <div class="container" th:if="${running_process or problems_exist}">

            <div class="white-rounded-back"style="width:700px;">

                <div class="panel-bar" style="padding-top: 3%">

                    <div th:if="${running_process}">

                        <div class="panel-bar">
                            <p class="form-inline" style="padding-top: 3%"> Model:  <span th:text="${model}"></span></p>
                            <p class="form-inline" style="padding-top: 3%"> Problemů:  <span th:text="${problem_amount}"></span></p>
                            <p class="form-inline" style="padding-top: 3%"> Celkem:  <span th:text="${total}"></span></p>
                            <p class="form-inline" style="padding-top: 3%"> Zkontrolovano:  <span th:text="${done}"></span></p>

                            <form class="form-inline" action="#" th:action="@{/check_solr_integrity}" method="post">
                                <button class="btn btn-outline-secondary btn-light" type="submit" name="action" value="stop"> Pozastavit proces </button>
                            </form>
                            <form class="form-inline">
                                <button class="btn btn-outline-secondary btn-light" onClick="window.location.reload();"> Obnovit stránku </button>
                            </form>
                        </div>
                    </div>

                    <div th:if="${not running_process}">

                        <div class="panel-bar">
                            <form class="form-inline" action="#" th:action="@{/check_solr_integrity}" method="post">
                                <button class="btn btn-outline-secondary btn-light" type="submit" name="action" value="clear"> Vyčistit </button>
                            </form>

                            <form class="form-inline" action="#" th:action="@{/check_solr_integrity}" method="post">
                                <button class="btn btn-outline-secondary btn-light" type="submit" name="action" value="download"> Stahnout seznam </button>
                            </form>
                        </div>
                    </div>

                    <div style="clear: both"></div>
                </div>
            </div>
        </div>

        <div th:if="${problems_exist}" style="padding: 1% 3%">
            <div class="card scrollable-list" style="width: auto;">
                <table class="table table-light">

                    <thead class="thead-light">
                    <tr>
                        <th class="uuid-column"> Uuid </th>
                        <th style="width: 23em;"> Název </th>
                        <th style="width: 40%"> Popis problému </th>
                    </tr>
                    </thead>

                    <tbody>
                    <tr th:each="problem : ${problems}">
                        <td th:text="${problem.key.getUuid()}"> Uuid </td>
                        <td th:text="${problem.key.getTitle()}"> Title </td>
                        <td th:text="${problem.value}"> Problem description </td>
                    </tr>
                    </tbody>
                </table>

            </div>
        </div>

    </body>
</html>